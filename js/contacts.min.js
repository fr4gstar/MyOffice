jQuery(document).ready(function(){function t(t){jQuery("#f_firstname"+t).val()||jQuery("#f_lastname"+t).val()||jQuery("#f_company"+t).val()||jQuery("#f_email"+t).val()||jQuery("#f_tel"+t).val()?jQuery.get("editContact.php",{cid:t,firstname:jQuery("#f_firstname"+t).val(),lastname:jQuery("#f_lastname"+t).val(),firm:jQuery("#f_company"+t).val(),email:jQuery("#f_email"+t).val(),tel:jQuery("#f_tel"+t).val(),note:jQuery("#f_note"+t).val()},function(t){"1"==t?(a(),alert("Kontakt erfolgreich angepasst!"),console.log("Edit contact successfull!")):(a(),alert("Kontakt konnte nicht angepasst werden!"),console.log("ERROR: Edit contact failed!"))}):alert("Bitte mindestens Vornamen/Nachnamen/Firma/Email oder Telefonnumer angeben!")}function e(e){jQuery("#showContacts").append("<table id='contactTable' href='#'><tr><th></th><th>#</th><th>Vorname</th><th>Nachname</th><th>Firma</th><th>Email</th><th>Telefonnummer</th></tr></table>");var n=$.parseJSON(e),l=1,r="",o="";for(jQuery("#ov_contacts").append("Kontakte<table id='ov_contactTable' href='#'><tr><th>Vorname</th><th>Nachname</th><th>Firma</th><th>Email</th></tr></table>");n[l];){var i=n[l][l][0],c=n[l][l][1],u=n[l][l][2],s=n[l][l][3],d=n[l][l][4],m=n[l][l][5],f=n[l][l][6];r+="<div id='dialog_c"+i+"' class='dialog'><form><fieldset><label for='f_firstname"+i+"'>Vorname</label><input type='text' name='firstname' id='f_firstname"+i+"' value='"+c+"' class='text ui-widget-content ui-corner-all'><br /><label for='f_lastname"+i+"'>Nachname</label><input type='text' name='lastname' id='f_lastname"+i+"' value='"+u+"' class='text ui-widget-content ui-corner-all'><br /><label for='f_company"+i+"'>Firma</label><input type='text' name='company' id='f_company"+i+"' value='"+s+"' class='text ui-widget-content ui-corner-all'><br /><label for='f_email'>Email</label><input type='text' name='email' id='f_email"+i+"' value='"+d+"' class='text ui-widget-content ui-corner-all'><br /><label for='tel'>Telefonnummer</label><input type='tel' name='f_tel' id='f_tel"+i+"' value='"+m+"' class='text ui-widget-content ui-corner-all'><br /><label for='note'>Notiz</label><br /><textarea name='note' id='f_note"+i+"' type='text' cols='40' rows='7' class='text ui-widget-content ui-corner-all'>"+f+"</textarea></fieldset></form></div>",o+="<tr><td><button id='btn_viewContact"+i+"' class='opener' data-id='#dialog_c"+i+"'>Bearbeiten</button><button id='btn_deleteContact"+i+"' class='btn_delete'>L&ouml;schen</button></td><td>"+l+"</td><td>"+c+"</td><td>"+u+"</td><td>"+s+"</td><td>"+d+"</td><td>"+m+"</td></tr>",l++}for(jQuery("#contactTable").append(o),jQuery("#showContacts").append(r),l=1;n[l];)jQuery("#btn_deleteContact"+n[l][l][0]).click(function(){var t=$(this).attr("id");t=t.toString().substring(17,t.toString().length),jQuery.get("deleteContact.php",{cid:t},function(t){"1"==t?(a(),alert("Kontakt erfolgreich entfernt!"),console.log("Delete contact successfull!")):(alert("Kontakt konnte nicht entfernt werden!"),console.log("Delete contact error!"))})}),l++;$(".dialog").dialog({autoOpen:!1}),$(".opener").click(function(){var e=$(this).data("id"),a=e.toString().substring(8,9);if("c"==a){var n=e.toString().substring(9,e.toString().length);$(e).dialog({autoOpen:!1,height:600,width:700,modal:!0,title:"Kontakt anpassen",buttons:{Speichern:function(){t(n),$(e).dialog("close")}},close:function(){}}),$(e).dialog("open")}});var p=Object.keys(n).length,y="";if(5>p)for(var h=0;p>h;h++)y+="<tr><td>"+n[p][p][1]+"</td><td>"+n[p][p][2]+"</td><td>"+n[p][p][3]+"</td><td>"+n[p][p][4]+"</td></tr>",p--;else for(var h=0;5>h;h++)y+="<tr><td>"+n[p][p][1]+"</td><td>"+n[p][p][2]+"</td><td>"+n[p][p][3]+"</td><td>"+n[p][p][4]+"</td></tr>",p--;jQuery("#ov_contactTable").append(y)}function a(){jQuery.get("contacts.php",{},function(t){jQuery("#showContacts").empty(),jQuery("#ov_contacts").empty(),e(t),console.log("Update Contacts successfull!")})}jQuery.get("contacts.php",{},function(t){jQuery("#contacts").append("<div id='tabs_contacts'><ul><li><a href='#showContacts'>Kontakte anzeigen</a></li><li><a href='#createContact'>Kontakt erstellen</a></li></ul><div id='showContacts'></div><div id='createContact'></div></div>"),$(function(){$("#tabs_contacts").tabs()}),e(t),jQuery("#createContact").append("Vorname<input id='firstname' maxlength='40' type='text'></input>Nachname<input id='lastname' maxlength='40' type='text'></input>Firma<input id='firm' maxlength='40' type='text'></input><br/>EMail<input id='email' maxlength='40' type='email' placeholder='G&uuml;ltige E-Mail Adresse angeben!'></input>TelNr.<input id='tel' type='tel' maxlength='40'></input><br/>Notiz<br/><textarea id='note' type='text' cols='40' rows='7' maxlength='2000'></textarea><br/><button id='btn_createContact' class='btn_add'>Kontakt erstellen</button>"),jQuery("#btn_createContact").click(function(){jQuery("#firstname").val()||jQuery("#lastname").val()||jQuery("#firm").val()||jQuery("#email").val()||jQuery("#tel").val()?jQuery.get("createContact.php",{firstname:jQuery("#firstname").val(),lastname:jQuery("#lastname").val(),firm:jQuery("#firm").val(),email:jQuery("#email").val(),tel:jQuery("#tel").val(),note:jQuery("#note").val()},function(t){"1"==t?(jQuery("#firstname").val(""),jQuery("#lastname").val(""),jQuery("#firm").val(""),jQuery("#email").val(""),jQuery("#tel").val(""),jQuery("#note").val(""),a(),alert("Kontakt erfolgreich erstellt!"),console.log("Create contact successfull!")):(alert("Kontakt konnte nicht erstellt werden!"),console.log("ERROR: Create contact successfull!"))}):alert("Bitte mindestens Vornamen/Nachnamen/Firma/Email oder Telefonnumer angeben!")})})});