jQuery(document).ready(function(){function e(e){jQuery("#f_title"+e).val()?jQuery.get("editNote.php",{nid:e,title:jQuery("#f_title"+e).val(),description:jQuery("#f_description"+e).val()},function(e){"1"==e?(t(),alert("Notiz erfolgreich angepasst!"),console.log("Edit note successfull!")):(t(),alert("Notiz konnte nicht angepasst werden!"),console.log("ERROR: Edit note failed!"))}):alert("Bitte mindestens einen Titel angeben!")}function t(){jQuery.get("Notes.php",{},function(e){jQuery("#showNotes").empty(),jQuery("#ov_notes").empty(),n(e),console.log("Update notes successfull!")})}function n(n){var i=$.parseJSON(n),o=1,l="",r="";for(jQuery("#showNotes").append("<div id='notesPanel'></div>"),jQuery("#notesPanel").append("<div class='column'></div>"),jQuery("#ov_notes").append("Notizen<table id='ov_noteTable' href='#'><tr><th>Titel</th><th>Beschreibung</th></tr></table>");i[o];){var a=i[o][o][0],s=i[o][o][1],d="",c=i[o][o][2],u="";s.toString().length>15?(d=s.toString().substring(0,15),d+="..."):d=s,c.toString().length>50?(u=c.toString().substring(0,50),u+="..."):u=c,l+="<div id='dialog_n"+a+"' class='dialog'><form><fieldset><label for='f_title"+a+"'>Titel</label><input type='text' maxlength='40' name='title' id='f_title"+a+"' value='"+s+"' class='text ui-widget-content ui-corner-all'><br /><label for='f_description"+a+"'>Beschreibung</label><br /><textarea name='note' id='f_description"+a+"' type='text' maxlength='2000' cols='40' rows='15' class='text ui-widget-content ui-corner-all'>"+c+"</textarea></fieldset></form></div>",r+="<div class='portlet'><div class='portlet-header'>#"+o+"<button id='btn_editNote"+a+"' data-id='#dialog_n"+a+"' class='opener btn_edit notes'>*</button><button id='btn_deleteNote"+a+"' class='btn_delete notes'>-</button><div>"+d+"</div></div><div class='portlet-content'>"+u+"</div></div>",o++}for(jQuery(".column").append(r),jQuery("#showNotes").append(l),o=1;i[o];)jQuery("#btn_deleteNote"+i[o][o][0]).click(function(){var e=$(this).attr("id");e=e.toString().substring(14,e.toString().length),jQuery.get("deleteNote.php",{nid:e},function(e){"1"==e?(t(),alert("Notiz erfolgreich entfernt!"),console.log("Delete note successfull!")):(alert("Notiz konnte nicht entfernt werden!"),console.log("Delete note error!"))})}),o++;$(function(){$(".column").sortable({connectWith:".column",handle:".portlet-header",placeholder:"portlet-placeholder ui-corner-all"}),$(".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all")}),$(".dialog").dialog({autoOpen:!1}),$(".opener").click(function(){var t=$(this).data("id"),n=t.toString().substring(8,9);if("n"==n){var i=t.toString().substring(9,t.toString().length);$(t).dialog({autoOpen:!1,height:600,width:700,modal:!0,title:"Notiz anpassen",buttons:{Speichern:function(){e(i),$(t).dialog("close")}},close:function(){}}),$(t).dialog("open")}});var g=Object.keys(i).length,p="",h="";if(5>g)for(var f=0;g>f;f++)i[g][g][2].toString().length>20?(h=i[g][g][2].toString().substring(0,20),h+="..."):h=i[g][g][2],p+="<tr><td>"+i[g][g][1]+"</td><td>"+h+"</td></tr>",g--;else for(var f=0;5>f;f++)i[g][g][2].toString().length>20?(h=i[g][g][2].toString().substring(0,20),h+="..."):h=i[g][g][2],p+="<tr><td>"+i[g][g][1]+"</td><td>"+h+"</td></tr>",g--;jQuery("#ov_noteTable").append(p)}jQuery.get("notes.php",{},function(e){jQuery("#notes").append("<div id='tabs_notes'><ul><li><a href='#showNotes'>Notizen anzeigen</a></li><li><a href='#createNote'>Notiz erstellen</a></li></ul><div id='showNotes'></div><div id='createNote'></div></div>"),$(function(){$("#tabs_notes").tabs()}),n(e),jQuery("#createNote").append("Titel<input id='title' maxlength='40' type='text'><br/>Beschreibung<br/><textarea id='description' type='text' maxlength='2000' cols='40' rows='15'></textarea><br/><button id='btn_createNote' class='btn_add'>Notiz erstellen</button>"),jQuery("#btn_createNote").click(function(){jQuery("#title").val()?jQuery.get("createNote.php",{title:jQuery("#title").val(),description:jQuery("#description").val()},function(e){"1"==e?(jQuery("#title").val(""),jQuery("#description").val(""),t(),alert("Notiz erfolgreich erstellt!"),console.log("Create note successfull!")):(alert("Notiz konnte nicht erstellt werden!"),console.log("ERROR: Create note successfull!"))}):alert("Bitte Titel angeben!")})})});